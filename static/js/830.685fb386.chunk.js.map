{"version":3,"file":"static/js/830.685fb386.chunk.js","mappings":"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","sources":["../../src/loader.js","../../src/contex.js","../../src/createWithFetchLang.js","../../src/index.js"],"sourcesContent":["export const message = {};\n\nconst loader = (locale, localeMessage, namespace) => {\n  if (!message[locale]) {\n    message[locale] = {};\n  }\n  message[locale][namespace || 'global'] = Object.assign({}, message[locale][namespace || 'global'], localeMessage);\n  return message;\n};\n\nexport const messagesLoader = (messages, namespace) => {\n  Object.keys(messages).forEach(locale => {\n    if (!message[locale]) {\n      message[locale] = {};\n    }\n    message[locale][namespace || 'global'] = Object.assign({}, message[locale][namespace || 'global'], messages[locale]);\n  });\n};\n\nexport default loader;\n","import { createContext } from '@kne/global-context';\n\nconst { Provider, useContext, context } = createContext({});\n\nexport { Provider, useContext };\n\nexport default context;\n","import Fetch from '@kne/react-fetch';\nimport { useGlobalValue, usePreset } from '@kne/global-context';\nimport localeLoader, { messagesLoader, message } from './loader';\nimport { IntlProvider, useIntl } from 'react-intl';\nimport React, { forwardRef } from 'react';\nimport { Provider as MessageProvider, useContext as useMessageContext } from './contex';\n\nconst argsParse = (...args) => {\n  if (typeof args[0] === 'object' && typeof args[0].defaultLocale === 'string') {\n    return Object.assign({}, args[0]);\n  }\n\n  return { defaultLocale: args[0], defaultMessage: args[1], namespace: args[2] };\n};\n\nconst createWithFetchLang = (...args) => {\n  const { defaultLocale, defaultMessage, namespace, messages } = argsParse(...args);\n  defaultMessage && localeLoader(defaultLocale, defaultMessage, namespace);\n  messages && messagesLoader(messages, namespace);\n  return WrappedComponents =>\n    forwardRef(({ locale: propsLocale, ...props }, ref) => {\n      const { apis } = usePreset();\n      const contextLocal = useGlobalValue('locale');\n      const locale = propsLocale || contextLocal || defaultLocale || 'zh-CN';\n      const currentNamespace = namespace || 'global';\n      const messages = message[locale]?.[currentNamespace];\n      const defaultLocalMessage = message[defaultLocale || 'zh-CN']?.[currentNamespace];\n      if (apis?.localeMessage && !(messages && Object.keys(messages).length > 0) && defaultLocalMessage && Object.keys(defaultLocalMessage).length > 0) {\n        return (\n          <Fetch\n            {...Object.assign({}, apis.localeMessage, { data: { locale, namespace: currentNamespace, defaultLang: defaultLocalMessage } })}\n            cache=\"intl-fetch-lang \"\n            render={({ data }) => {\n              messagesLoader({ [locale]: data }, currentNamespace);\n              const messages = message[locale]?.[currentNamespace];\n              return (\n                <IntlProvider messages={messages} locale={locale}>\n                  <WrappedComponents {...props} ref={ref} />\n                </IntlProvider>\n              );\n            }}\n          />\n        );\n      }\n      const prevMessage = useMessageContext();\n      const currentMessage = Object.assign({}, prevMessage, messages);\n      return (\n        <IntlProvider messages={currentMessage} locale={locale}>\n          <MessageProvider value={currentMessage}>\n            <WrappedComponents {...props} ref={ref} />\n          </MessageProvider>\n        </IntlProvider>\n      );\n    });\n};\n\nexport default createWithFetchLang;\n","import React, { forwardRef } from 'react';\nimport localeLoader, { message, messagesLoader } from './loader';\nimport { IntlProvider, createIntl as createIntlBase, useIntl } from 'react-intl';\nimport { useGlobalValue } from '@kne/global-context';\nimport createWithFetchLang from './createWithFetchLang';\n\nconst withIntlProvider = WrappedComponents =>\n  forwardRef(({ locale: propsLocale, namespace, ...props }, ref) => {\n    const contextLocal = useGlobalValue('locale');\n    const locale = propsLocale || contextLocal || 'zh-CN';\n    return (\n      <IntlProvider messages={message[locale]?.[namespace || 'global']} locale={locale}>\n        <WrappedComponents {...props} ref={ref} />\n      </IntlProvider>\n    );\n  });\n\nconst argsParse = (...args) => {\n  if (typeof args[0] === 'object' && typeof args[0].defaultLocale === 'string') {\n    return Object.assign({}, args[0]);\n  }\n\n  return { defaultLocale: args[0], defaultMessage: args[1], namespace: args[2] };\n};\n\nexport const createIntlProvider = (...args) => {\n  const withIntlProvider = createWithFetchLang(...args);\n  const InnerComponent = ({ children }) => {\n    const intl = useIntl();\n    return children(intl);\n  };\n  return withIntlProvider(({ locale: propsLocale, children }) => {\n    return typeof children === 'function' ? <InnerComponent>{children}</InnerComponent> : children;\n  });\n};\n\nexport const createWithIntlProvider = createWithFetchLang;\n\nexport * from 'react-intl';\n\nexport const createIntl = ({ locale = 'zh-CN', message: propsMessage, namespace }) => {\n  propsMessage && localeLoader(locale, propsMessage, namespace);\n  return createIntlBase({ locale, messages: message[locale]?.[namespace || 'global'] });\n};\n\nexport { localeLoader, IntlProvider };\n\nexport default createIntl;\n"],"names":["message","loader","locale","localeMessage","namespace","Object","assign","messagesLoader","messages","keys","forEach","Provider","useContext","context","createContext","createWithFetchLang","defaultLocale","defaultMessage","_len","arguments","length","args","Array","_key","argsParse","WrappedComponents","forwardRef","_ref","ref","_message$locale","_message","propsLocale","props","_objectWithoutPropertiesLoose","_excluded","apis","usePreset","contextLocal","useGlobalValue","currentNamespace","defaultLocalMessage","React","Fetch","_extends","data","defaultLang","cache","render","_ref2","_message$locale2","IntlProvider","prevMessage","currentMessage","value","createIntlProvider","withIntlProvider","InnerComponent","_ref3","children","useIntl","_ref4","createWithIntlProvider","createIntl","_ref5","_locale","propsMessage","_message$_locale","createIntl$1"],"ignoreList":[],"sourceRoot":""}